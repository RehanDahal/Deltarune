<script>
launch()

function launch() {
  try {
    fetch('deltarune.html?t=' + Date.now())
      .then(response => response.text())
      .then(html => {
        document.documentElement.innerHTML = html

        // Wait for DOM to fully render
        window.addEventListener('DOMContentLoaded', () => {
          const menumoveaudio = new Audio('audios/snd_menumove.mp3')
          const menuselectaudio = new Audio('audios/snd_select.mp3')
          menumoveaudio.preload = 'auto'
          menuselectaudio.preload = 'auto'

          document.querySelectorAll('.row').forEach(row => {
            row.addEventListener('mouseenter', () => {
              menumoveaudio.currentTime = 0
              menumoveaudio.play()
            })
            row.addEventListener('click', () => {
              menuselectaudio.currentTime = 0
              menuselectaudio.play()
            })
          })
        })

        // Re-add scripts from fetched HTML
        document.documentElement.querySelectorAll('script').forEach(oldScript => {
          const newScript = document.createElement('script')
          if (oldScript.src) {
            newScript.src = oldScript.src
          } else {
            newScript.textContent = oldScript.textContent
          }
          document.body.appendChild(newScript)
        })
      })
  } catch (error) {
    console.error('error:', error)
  }
}
</script>
